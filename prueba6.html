<!DOCTYPE html>
<html>
<head>
    <title>Aixecaments topogràfics AMB</title>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.11.0/mapbox-gl.css' rel='stylesheet' />

    <link href="css/styles.css" rel="stylesheet">
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.11.0/mapbox-gl.js'></script>
    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoidGlhbmxpbGxvIiwiYSI6ImNsY3ludnBmODBhY2Izcm5vYzRibzd3YXoifQ.gOZiyMs0U6_TPz_qK1nvIw';
        var map;
        var aixecamentsLayer;

        function initialize() {
            map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/tianlillo/clskq3n7o009201qwakqj8vg2',
                center: [2.16859, 41.3954],
                zoom: 10,
                maxZoom: 20,
                attributionControl: false,
                hash: true
            });

            // Agregar capa de aixecaments desde el archivo geojson
            map.on('load', function () {
                map.addSource('aixecaments', {
                    type: 'geojson',
                    data: 'datos/aixecaments.geojson'
                });

                aixecamentsLayer = {
                    'id': 'aixecaments-layer',
                    'type': 'fill',
                    'source': 'aixecaments',
                    'layout': {},
                    'paint': {
                        'fill-color': '#088',
                        'fill-opacity': 0.8
                    }
                };

                map.addLayer(aixecamentsLayer);
            });
        }

        function filtrarAixecaments(mandat) {
            if (mandat === '') {
                // Si el valor es vacío, mostrar todos los aixecaments cuyo OBJECTID sea mayor que 1
                map.setFilter('aixecaments-layer', ['>', 'OBJECTID', 0]);
            } else {
                // Si hay un valor seleccionado, filtrar los aixecaments según ese valor
                map.setFilter('aixecaments-layer', ['==', 'mandat', mandat]);
            }
        }



        window.onload = initialize;
    </script>
</head>
<body>
<div class="header">
    <p><img src="imagen/logo.png"/></p>
    <h1>Aixecaments topogràfics de l'AMB</h1>
</div>
<div class="menu">
    <ul>
        <li>
            <select onchange="filtrarAixecaments(this.value)">
                <option value="">Todos</option>
                <option value="2008-2011">2008-2011</option>
                <option value="2012-2015">2012-2015</option>
                <option value="2016-2019">2016-2019</option>
                <option value="2020-2023">2020-2023</option>
                <option value="2024-2027">2024-2027</option>
            </select>
        </li>
    </ul>
</div>

<div class="wrapper">
    <div id="map" style="width: 100%; height: 600px;"></div>
</div>
</body>
</html>
